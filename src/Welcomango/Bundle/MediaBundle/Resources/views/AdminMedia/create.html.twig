{% extends "::admin.html.twig" %}

{% trans_default_domain "crm" %}

{% set listing = path('admin_media_list') %}
{% form_theme form with ["::theme.html.twig"] %}

{% block page_content %}
    <div class="col-md-12">
        <div class="panel panel-default portlet">
            <div class="panel-body">
                {{ form_start(form, {'action': path('admin_media_create'), 'attr': {'novalidate': 'novalidate', 'id': 'mediaForm'}}) }}
                {% include "WelcomangoMediaBundle:AdminMedia:form.html.twig" with { 'form': form } %}
                {% include "WelcomangoCoreBundle:Form:formFooter.html.twig" with {'listing' : listing, 'update': form.vars.id } only %}
                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {{ form_stylesheet(form) }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ include('@WelcomangoMedia/AdminMedia/_baseJs.html.twig', {
        'templateReturn' : 'WelcomangoMediaBundle:AdminMedia:_renderImages.html.twig',
        'idSearch'       : 'admin_language_file',
        'formName'       : 'admin_language',
        'idForm'         : 'mediaForm',
        'multiple'       : 'false',
        'inputName'      : 'file',
    }) }}
z
    <script type="text/javascript">
        $('#crop-image').click(function () {
            $.ajax({
                url: '{{ path('media_crop') }}',  //Server script to process data
                type: 'POST',
                //Ajax events
                error: function (request) {
                    console.log(request);
                },
                success: function (data) {
                    $("#medias").append(data);
                },
                // Form data
                data: formData,
                //Options to tell jQuery not to process data or worry about content-type.
                cache: false,
                contentType: false,
                processData: false
            });
        });
    </script>

    {{ form_javascript(form) }}
{% endblock %}
